---
title: "amoA_AOB phylogenetic tree"
author: "Paul Villanueva"
date: "1/20/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(ape)
library(ggplot2)
library(ggtree)
library(phytools)
library(stringr)
library(tidyverse)

theme_set(theme_light())
```

## Read in data

```{r amoa_aob.data}
amoa_tree <- read.tree("./data/amoA_AOB_unaligned_clustered.95.protein_seqs.prepped_headers.fa.tree")
```

### Fixing labels

```{r amoa_aob.labels}
amoa_tree <- read.tree("./data/amoA_AOB_unaligned_clustered.95.protein_seqs.prepped_headers.fa.tree")
for (i in 1:length(amoa_tree$tip.label)){
  temp <- unlist(str_split(amoa_tree$tip.label[i], "_"))
  org_name <- str_replace(unlist(lapply(temp[-c(1, 2)], function(x) x[!x %in% ""])), "\\bsp\\b", "sp.")

  new_label <- vector(mode = "character", length = length(org_name))
  for(k in 1:length(org_name)){
    if (str_detect(org_name[k], "Nitro") ||
        org_name[k] %in% c("halophilus", "oceani", "cryotolerans", "multiformis", "briensis")){
      new_label[k] <- str_glue("italic(\"{org_name[k]}\")")
      } else {
      new_label[k] <- str_glue("plain(\"{org_name[k]}\")")
    }
  }
  new_label[length(new_label) + 1] <- paste0("\"(", temp[2], ")\"")
  amoa_tree$tip.label[i] <- parse(text = paste(new_label, collapse = " * \" \" * "))
}
```

### Plotting 

```{r amoa_aob.plot}
plot(amoa_tree, no.margin = TRUE) 
add.scale.bar(font = 2)
```
